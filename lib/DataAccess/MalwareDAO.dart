import 'dart:convert' as convert;
import 'package:magik_antivirus/utils/DBUtils.dart';
import 'package:magik_antivirus/model/Signature.dart';

class SignatureDAO{
  Future<List<Signature>> getSigs()async{
    List<Signature> sigs = [];
    var uri = Uri.http(APIReaderUtils.apiRESTLink, "signatures/");
    var body = await APIReaderUtils.getData(uri);
    if(body!="noBody"){
      var json = convert.jsonDecode(body) as List<Map<String, String>>;
      for(var line in json){
        sigs.add(Signature(type: line["type"]!, signature: line["signature"]!));
      }
    }
    return sigs;
  }
}